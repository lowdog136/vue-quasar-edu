# Настройка Event Table в Firebase

## Описание
Компонент `GamesNowTable` теперь использует Firebase коллекцию `event-table` для хранения данных о турнирной таблице.

## Структура данных

Каждая запись в коллекции `event-table` содержит следующие поля:

```javascript
{
  id: Number,           // Уникальный ID команды
  text_a: String,       // CSS класс для выравнивания (по умолчанию 'text-left')
  text_c: String,       // CSS класс для цвета (по умолчанию 'primary')
  name: String,         // Название команды
  color: String,        // Цвет команды (по умолчанию 'primary')
  games: Number,        // Количество сыгранных игр
  win: Number,          // Количество побед
  draw: Number,         // Количество ничьих
  lose: Number,         // Количество поражений
  ball_in: Number,      // Голы забитые
  ball_out: Number,     // Голы пропущенные
  score: Number,        // Очки
  last_game: String,    // Последние игры (например: 'ВВ' - победа, победа)
  icon: String          // Иконка команды (Material Icon, по умолчанию 'sports_soccer')
}
```

## Инициализация данных

### Способ 1: Через админскую страницу
1. Перейдите на страницу `/Admin/TomatAdminPage`
2. Найдите секцию "Управление таблицей событий"
3. Нажмите кнопку "Инициализировать данные"
4. Данные будут автоматически добавлены в коллекцию

### Способ 2: Программно
```javascript
import { initEventTable } from 'src/firebase'

// Инициализация с данными по умолчанию
await initEventTable()
```

## Управление данными

### Добавление новой записи
```javascript
import { addEventTableRecord } from 'src/firebase'

const newRecord = {
  id: 7,
  name: 'Новая команда',
  games: 0,
  win: 0,
  draw: 0,
  lose: 0,
  ball_in: 0,
  ball_out: 0,
  score: 0,
  last_game: ''
}

await addEventTableRecord(newRecord)
```

### Очистка коллекции
```javascript
import { clearEventTable } from 'src/firebase'

await clearEventTable()
```

## Компоненты

### gameTable.vue
Основной компонент таблицы, который:
- Загружает данные из Firebase коллекции `event-table`
- Отображает турнирную таблицу с отдельными колонками для забитых и пропущенных голов
- Показывает индивидуальные иконки команд перед названиями
- Автоматически обновляется при изменении данных в Firebase
- Сортирует команды по очкам (по убыванию), при равенстве очков - по разнице голов (по возрастанию), при равенстве разницы - по количеству забитых голов (по убыванию)

### TomatAdminPage.vue
Админская страница для управления данными:
- Инициализация коллекции
- Очистка данных
- Просмотр текущих данных

### EventTableEditor.vue
Компонент для редактирования таблицы событий:
- Интерактивная таблица с возможностью редактирования всех полей
- Редактирование иконок команд
- Добавление новых команд через диалог с выбором иконки
- Удаление команд с подтверждением
- Автосохранение изменений в Firebase

## Структура таблицы

Таблица содержит следующие колонки:
1. **1 этап** - Название команды
2. **И** - Количество игр
3. **В** - Количество побед
4. **Н** - Количество ничьих
5. **П** - Количество поражений
6. **З** - Забитые голы (ball_in)
7. **П** - Пропущенные голы (ball_out)
8. **О** - Очки
9. **Ф** - Форма (последние игры)

## Иконки команд

Каждая команда может иметь свою индивидуальную иконку, которая хранится в поле `icon` в Firebase. Используются Material Icons.

### Примеры популярных иконок:
- `sports_soccer` - Футбольный мяч (по умолчанию)
- `flag` - Флаг
- `star` - Звезда
- `shield` - Щит
- `fire` - Огонь
- `bolt` - Молния
- `diamond` - Алмаз
- `crown` - Корона

### Как изменить иконку:
1. В админской панели перейдите к редактированию команды
2. В колонке "Иконка" введите название Material Icon
3. Изменения сохранятся автоматически

Полный список доступных иконок можно найти на [Material Icons](https://material.io/icons/)

### Логика сортировки
Команды сортируются по следующим критериям:
1. **По очкам** - от большего к меньшему (по убыванию)
2. **При равенстве очков** - по разнице забитых и пропущенных голов от меньшей к большей (по возрастанию)
3. **При равенстве разницы голов** - по количеству забитых голов от большего к меньшему (по убыванию)

Пример сортировки:
- Команда А: 6 очков, разница голов +3, забито 4 гола
- Команда Б: 6 очков, разница голов +2, забито 2 гола
- Команда В: 4 очка, разница голов +2, забито 3 гола

Результат: Команда А (6 очков, +3, 4 гола), Команда Б (6 очков, +2, 2 гола), Команда В (4 очка, +2, 3 гола)

## Безопасность

Убедитесь, что в правилах безопасности Firebase разрешены операции чтения для коллекции `event-table`:

```javascript
rules_version = '2';
service cloud.firestore {
  match /databases/{database}/documents {
    match /event-table/{document} {
      allow read: if true;  // Разрешить чтение всем
      allow write: if request.auth != null;  // Запись только авторизованным
    }
  }
}
```

## Использование

После инициализации данных таблица будет автоматически отображаться на странице `/GamesNow/GamesNowTable` с актуальными данными из Firebase.

Данные обновляются в реальном времени благодаря использованию `onSnapshot` из Firebase Firestore.
